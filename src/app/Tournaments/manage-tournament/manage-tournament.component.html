<div id="HeaderContainer" *ngIf="!presentSelected">
  <header>
    <button type="button" routerLink="/">
      <img
        id="logo"
        *ngIf="!isDarkMode"
        alt="Logo"
        src="assets/images/CornholeLogo.png"
      />
      <img
        id="logo"
        *ngIf="isDarkMode"
        alt="Logo"
        src="assets/images/CornholeLogoDarkMode.png"
      />
    </button>
    <div class="header-inner">
      <h1 id="title">KCA Cornhole Tournaments</h1>
    </div>
    <div
      class="lang-dropdown-global"
      [class.open]="langDropdownOpen"
      (mouseleave)="langDropdownOpen = false"
    >
      <button
        class="lang-btn"
        (click)="toggleLangDropdown()"
        aria-label="Sprache w√§hlen"
      >
        <img
          [src]="getFlagUrl(selectedLang)"
          [alt]="selectedLang"
          style="height: 1em; vertical-align: middle"
        />
        <span class="arrow">&#9662;</span>
      </button>
      <ul class="lang-list" *ngIf="langDropdownOpen">
        <li *ngFor="let lang of languages" (click)="setLang(lang.code)">
          <img
            [src]="getFlagUrl(lang.code)"
            [alt]="lang.label"
            style="height: 1em; vertical-align: middle"
          />
          {{ lang.label }}
        </li>
      </ul>
    </div>
  </header>

  <nav *ngIf="!presentSelected">
    <div class="navbar-toggle" (click)="toggleNav()">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <div class="nav-links" [ngClass]="{ open: isNavOpen }">
      <button routerLink="/" class="nav-btn">{{ t.home }}</button>
      <button routerLink="/join" class="nav-btn">{{ t.joinTournament }}</button>
      <button routerLink="/create" class="nav-btn">
        {{ t.createTournament }}
      </button>
      <button routerLink="/manage" class="nav-btn active">
        {{ t.manageTournaments }}
      </button>
      <button routerLink="/stats" class="nav-btn">{{ t.statistics }}</button>
      <button routerLink="/about" class="nav-btn">{{ t.about }}</button>
    </div>
    <div class="auth-buttons">
      <ng-container *ngIf="!globalAuth.isLoggedIn">
        <button
          id="loginBtn"
          class="sign-buttons"
          (click)="globalAuth.openLoginModal()"
        >
          {{ t.login }}
        </button>
        <button
          id="registerBtn"
          class="sign-buttons outline"
          (click)="globalAuth.openRegisterModal()"
        >
          {{ t.register }}
        </button>
      </ng-container>
      <ng-container *ngIf="globalAuth.isLoggedIn">
        <div class="auth-row">
          <div class="user-info">
            <p id="username">{{ globalAuth.username }}</p>
            <button
              id="profileBtn"
              class="profile-btn"
              (click)="goToProfile()"
              title="Profil"
              type="button"
            >
              <img
                [src]="
                  globalAuth.profileImageUrl ||
                  'assets/images/default-profile.png'
                "
                alt="Profil"
                class="profile-icon"
              />
            </button>
          </div>
          <button
            id="registerBtn"
            class="sign-buttons outline"
            *ngIf="
              globalAuth.isLoggedIn &&
              (selectedLang === 'fr' || selectedLang === 'es')
            "
            [attr.lang-fr]="selectedLang === 'fr' ? true : null"
            [attr.lang-es]="selectedLang === 'es' ? true : null"
            (click)="globalAuth.logout()"
          >
            {{ t.logout }}
          </button>
          <button
            id="registerBtn"
            class="sign-buttons outline"
            *ngIf="
              globalAuth.isLoggedIn &&
              !(selectedLang === 'fr' || selectedLang === 'es')
            "
            (click)="globalAuth.logout()"
          >
            {{ t.logout }}
          </button>
        </div>
      </ng-container>
    </div>
    <button
      id="toggleTheme"
      title="We recommend Darkmode for the best experience"
      (click)="toggleTheme()"
    >
      <span class="switch"></span>
    </button>
  </nav>

  <div *ngIf="globalAuth.isAuthModalOpen" class="auth-modal">
    <div class="auth-modal-content">
      <span class="close-btn" (click)="globalAuth.closeModal()">&times;</span>
      <h2 class="auth-title">
        {{ globalAuth.isRegisterMode ? t.register : t.login }}
      </h2>
      <form #authForm="ngForm" (ngSubmit)="globalAuth.onSubmit()">
        <label for="username" class="auth-label">{{
          globalAuth.isRegisterMode ? t.username : t.usernameOrEmail
        }}</label>
        <input
          id="username"
          class="auth-input"
          name="username"
          type="text"
          [(ngModel)]="globalAuth.loginModel.username"
          required
        />

        <ng-container *ngIf="globalAuth.isRegisterMode">
          <label for="email" class="auth-label">{{ t.email }}</label>
          <input
            id="email"
            class="auth-input"
            name="email"
            type="email"
            [(ngModel)]="globalAuth.loginModel.email"
            required
          />
        </ng-container>

        <label for="password" class="auth-label">{{ t.password }}</label>
        <div class="input-wrapper">
          <input
            id="password"
            class="auth-input"
            name="password"
            [type]="showPassword ? 'text' : 'password'"
            [(ngModel)]="globalAuth.loginModel.password"
            required
          />
          <button
            type="button"
            class="eye-btn"
            (click)="showPassword = !showPassword"
            aria-label="Toggle password visibility"
          >
            <svg
              *ngIf="!showPassword"
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 5c-7.633 0-12 7-12 7s4.367 7 12 7 12-7 12-7-4.367-7-12-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"
              />
              <circle cx="12" cy="12" r="2.5" />
            </svg>

            <svg
              *ngIf="showPassword"
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 5c-7.633 0-12 7-12 7s4.367 7 12 7 12-7 12-7-4.367-7-12-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"
                stroke-width="2"
              />
              <line x1="1" y1="1" x2="23" y2="23" stroke-width="2" />
            </svg>
          </button>
        </div>

        <label
          *ngIf="!showResetForm && !globalAuth.isRegisterMode"
          class="forgot-link"
        >
          <a href="#" (click)="showResetForm = true; $event.preventDefault()">{{
            t.passwordReset
          }}</a>
        </label>

        <ng-container *ngIf="globalAuth.isRegisterMode">
          <label for="confirmPassword" class="auth-label">{{
            t.confirmPassword
          }}</label>
          <div class="input-wrapper">
            <input
              id="confirmPassword"
              class="auth-input"
              name="confirmPassword"
              [type]="showConfirmPassword ? 'text' : 'password'"
              [(ngModel)]="globalAuth.loginModel.confirmPassword"
              required
            />
            <button
              type="button"
              class="eye-btn eye-register"
              (click)="showConfirmPassword = !showConfirmPassword"
              aria-label="Toggle password visibility"
            >
              <svg
                *ngIf="!showConfirmPassword"
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12 5c-7.633 0-12 7-12 7s4.367 7 12 7 12-7 12-7-4.367-7-12-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"
                />
                <circle cx="12" cy="12" r="2.5" />
              </svg>

              <svg
                *ngIf="showConfirmPassword"
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12 5c-7.633 0-12 7-12 7s4.367 7 12 7 12-7 12-7-4.367-7-12-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"
                  stroke-width="2"
                />
                <line x1="1" y1="1" x2="23" y2="23" stroke-width="2" />
              </svg>
            </button>
          </div>
        </ng-container>
        <div class="remember-me-row">
          <label class="remember-me-label">
            <input
              type="checkbox"
              [(ngModel)]="globalAuth.loginModel.rememberMe"
              name="rememberMe"
              class="remember-me-checkbox"
            />
            <span class="custom-checkbox"></span>
            {{ t.rememberMe }}
          </label>
        </div>

        <div *ngIf="globalAuth.errorMessage" class="auth-error">
          {{ globalAuth.errorMessage }}
        </div>

        <button class="LogButton" type="submit">
          {{ globalAuth.isRegisterMode ? t.createAccount : t.login }}
        </button>
      </form>

      <div
        *ngIf="showResetForm && !globalAuth.isRegisterMode"
        class="reset-form"
      >
        <label for="resetEmail" class="auth-label">{{
          t.resetEmailLabel
        }}</label>
        <input
          id="resetEmail"
          class="auth-input"
          name="resetEmail"
          type="email"
          [(ngModel)]="globalAuth.resetEmail"
          required
        />
        <button
          class="LogButton"
          (click)="globalAuth.requestReset()"
          type="button"
        >
          {{ t.resetSend }}
        </button>
        <button
          class="LogButton outline"
          (click)="showResetForm = false"
          type="button"
        >
          {{ t.resetBack }}
        </button>
        <div *ngIf="resetRequested" class="reset-success">
          {{ t.resetSuccess }}
        </div>
      </div>

      <div class="register-link">
        <a href="#" id="toggleAuthMode" (click)="globalAuth.toggleMode($event)">
          {{ globalAuth.isRegisterMode ? t.alreadyAccount : t.noAccount }}
        </a>
      </div>
    </div>
  </div>
</div>

<main>
  <div class="tournament-select-menu">
    <button
      (click)="showTournamentMenu = !showTournamentMenu"
      style="
        padding: 0.5rem 1.2rem;
        border-radius: 0.7rem;
        background: var(--accent);
        color: var(--bg);
        font-weight: 600;
        border: none;
        cursor: pointer;
      "
    >
      Meine gespeicherten Turniere &#9662;
    </button>
    <div
      *ngIf="showTournamentMenu"
      style="
        background: var(--bg);
        border: 1.5px solid var(--accent);
        border-radius: 0.7rem;
        margin: 0.5rem auto 0 auto;
        max-width: 350px;
        box-shadow: 0 2px 12px #0002;
        position: relative;
        z-index: 10;
      "
    >
      <ul style="list-style: none; margin: 0; padding: 0.5rem 0">
        <li
          *ngFor="let t of savedTournaments"
          style="
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-bottom: 1px solid #2222;
          "
          (click)="selectTournament(t.id); showTournamentMenu = false"
        >
          {{ t.name || "Turnier " + t.id }}
        </li>
        <li
          *ngIf="!savedTournaments.length"
          style="padding: 0.5rem 1rem; color: #888"
        >
          Keine gespeicherten Turniere
        </li>
      </ul>
    </div>
  </div>
  <div *ngIf="showMobileWarning" class="mobile-warning-overlay">
    <div class="mobile-warning-box">
      <button
        class="mobile-warning-close"
        (click)="showMobileWarning = false"
        aria-label="Schlie√üen"
      >
        &times;
      </button>
      <span class="mobile-warning-text">{{
        translations[selectedLang].mobileWarning
      }}</span>
    </div>
  </div>
  <section>
    <div class="Dropdown-Wrapper">
      <div class="Dropdown-Container">
        <div class="sidebar" [class.open]="isOpen">
          <button class="toggle-btn" (click)="isOpen = !isOpen">
            <span class="material-icons">menu</span>
          </button>
          <nav>
            <ul>
              <li>
                <button
                  (click)="editSelect(); activeBtn = 'edit'"
                  [class.active]="activeBtn === 'edit'"
                >
                  <span class="material-icons">tune</span>
                  <span class="label">{{ t.edit }}</span>
                </button>
              </li>
              <li>
                <button
                  (click)="participantsSelect(); activeBtn = 'participants'"
                  [class.active]="activeBtn === 'participants'"
                >
                  <span class="material-icons">group</span>
                  <span class="label">{{ t.participants }}</span>
                </button>
              </li>
              <li>
                <button
                  (click)="bracketSelect(); activeBtn = 'bracket'"
                  [class.active]="activeBtn === 'bracket'"
                >
                  <span class="material-icons">account_tree</span>
                  <span class="label">{{ t.bracket }}</span>
                </button>
              </li>
              <li>
                <button
                  (click)="scheduleSelect(); activeBtn = 'schedule'"
                  [class.active]="activeBtn === 'schedule'"
                >
                  <span class="material-icons">event</span>
                  <span class="label">{{ t.schedule }}</span>
                </button>
              </li>
              <li>
                <button
                  (click)="extendedSelect(); activeBtn = 'advanced'"
                  [class.active]="activeBtn === 'advanced'"
                >
                  <span class="material-icons">settings</span>
                  <span class="label">{{ t.Advanced }}</span>
                </button>
              </li>
              <li>
                <button
                  (click)="presentSelect(); activeBtn = 'present'"
                  [class.active]="activeBtn === 'present'"
                >
                  <span class="material-icons">slideshow</span>
                  <span class="label">{{ t.present }}</span>
                </button>
              </li>
              <li>
                <button
                  (click)="resultsSelect(); activeBtn = 'results'"
                  [class.active]="activeBtn === 'results'"
                >
                  <span class="material-icons">bar_chart</span>
                  <span class="label">{{ t.results }}</span>
                </button>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
    <div class="edit-container" *ngIf="editSelected">
      <div class="edit-main">
        <div class="imgContainer">
          <div class="edit-avatar-block">
            <img
              (click)="showImage('assets/images/TournamentFiller.png')"
              class="edit-avatar"
              src="assets/images/TournamentFiller.png"
              alt="Turnier Logo"
            />
            <button
              class="edit-btn"
              title="{{ t.changeeditImage || 'Profilbild √§ndern' }}"
              (click)="avatarInput.click()"
            >
              <span class="material-icons">edit</span>
            </button>
            <input
              #avatarInput
              type="file"
              accept="image/*"
              (change)="onImageChange($event)"
              hidden
            />
          </div>

          <div class="edit-avatar-block">
            <img
              (click)="showImage('assets/images/CornholeLogoDarkMode.png')"
              class="edit-avatar tournament-image"
              src="assets/images/CornholeLogoDarkMode.png"
              alt="Turnier Bild"
            />
            <button
              class="edit-btn"
              title="{{ t.changeeditImage || 'Profilbild √§ndern' }}"
              (click)="avatarInput.click()"
            >
              <span class="material-icons">edit</span>
            </button>
            <input
              #avatarInput
              type="file"
              accept="image/*"
              (change)="onImageChange($event)"
              hidden
            />
          </div>

          <div class="image-modal" *ngIf="showImageModal">
            <div class="image-modal-backdrop" (click)="closeImageModal()"></div>
            <div class="image-modal-content">
              <img [src]="modalImageSrc" alt="Tournament Large" />
              <button
                class="close-image-btn tButton"
                (click)="closeImageModal()"
              >
                &times;
              </button>
            </div>
          </div>
        </div>
        <div class="edit-info-block">
          <div class="edit-row">
            <span class="edit-label">{{ t.editNametitle }}</span>
            <div class="value-btn-wrapper">
              <span *ngIf="!editName && tournament?.name" class="edit-value">{{
                tournament.name
              }}</span>
              <input
                *ngIf="editName"
                [(ngModel)]="tournament.name"
                class="edit-input"
                [placeholder]="tournament?.name"
              />
              <button class="edit-btn" (click)="editName = !editName">
                <span class="material-icons">{{
                  editName ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row">
            <span class="edit-label">{{ t.editorganizertitle }}</span>
            <div class="value-btn-wrapper">
              <span
                *ngIf="!editOrganizer && tournament?.organizer"
                class="edit-value"
                >{{ tournament.organizer }}</span
              >
              <input
                *ngIf="editOrganizer"
                [(ngModel)]="tournament.organizer"
                class="edit-input"
                [placeholder]="tournament?.organizer"
              />
              <button class="edit-btn" (click)="editOrganizer = !editOrganizer">
                <span class="material-icons">{{
                  editOrganizer ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row">
            <span class="edit-label">{{ t.editDatetitle }}</span>
            <div class="value-btn-wrapper">
              <span *ngIf="!editDate && tournament?.date" class="edit-value">{{
                tournament.date
              }}</span>
              <input
                *ngIf="editDate"
                [(ngModel)]="tournament.date"
                class="edit-input"
                type="date"
                [placeholder]="tournament?.date"
              />
              <button class="edit-btn" (click)="editDate = !editDate">
                <span class="material-icons">{{
                  editDate ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row">
            <span class="edit-label">{{ t.editLocationtitle }}</span>
            <div class="value-btn-wrapper">
              <span
                *ngIf="!editLocation && tournament?.location"
                class="edit-value"
                >{{ tournament.location }}</span
              >
              <input
                *ngIf="editLocation"
                [(ngModel)]="tournament.location"
                class="edit-input"
                type="text"
                [placeholder]="tournament?.location"
              />
              <button class="edit-btn" (click)="editLocation = !editLocation">
                <span class="material-icons">{{
                  editLocation ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row bio-row">
            <span class="edit-label">{{ t.editNotestitle }}</span>
            <div class="value-btn-wrapper">
              <span
                *ngIf="!editNotes && tournament?.notes"
                class="edit-value note-text"
                style="white-space: pre-line; word-break: break-word"
                >{{ tournament.notes }}</span
              >
              <textarea
                *ngIf="editNotes"
                [(ngModel)]="tournament.notes"
                class="bio-input"
                [placeholder]="tournament?.notes"
              ></textarea>
              <button class="edit-btn" (click)="editNotes = !editNotes">
                <span class="material-icons">{{
                  editNotes ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row bio-row">
            <span class="edit-label">{{ t.editRulestitle }}</span>
            <div
              *ngIf="editRules"
              class="rules-hint"
              style="font-size: 0.97em; color: #aaa; margin-bottom: 0.3em"
            >
              <span>
                {{ t.ruleHint }}
              </span>
            </div>
            <div class="value-btn-wrapper">
              <ul
                *ngIf="!editRules && tournament?.rules"
                class="edit-value rules-list"
                style="margin: 0; padding-left: 1.2em"
              >
                <li *ngFor="let rule of tournament.rules.split('\n')">
                  {{ rule }}
                </li>
              </ul>
              <textarea
                *ngIf="editRules"
                [(ngModel)]="tournament.rules"
                class="bio-input"
                [placeholder]="tournament?.rules"
              ></textarea>
              <button class="edit-btn" (click)="editRules = !editRules">
                <span class="material-icons">{{
                  editRules ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row">
            <span class="edit-label">{{ t.editTeamstitle }}</span>
            <div class="value-btn-wrapper">
              <span
                *ngIf="!editTeams && tournament?.teams"
                class="edit-value"
                >{{ tournament.teams }}</span
              >
              <input
                *ngIf="editTeams"
                [(ngModel)]="tournament.teams"
                class="edit-input"
                type="number"
                [placeholder]="tournament?.teams"
              />
              <button class="edit-btn" (click)="editTeams = !editTeams">
                <span class="material-icons">{{
                  editTeams ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row">
            <span class="edit-label">{{ t.editFeetitle }}</span>
            <div class="value-btn-wrapper">
              <span *ngIf="!editFee && tournament?.fee" class="edit-value">{{
                tournament.fee
              }}</span>
              <input
                *ngIf="editFee"
                [(ngModel)]="tournament.teams"
                class="edit-input"
                type="number"
                [placeholder]="tournament?.fee"
              />
              <button class="edit-btn" (click)="editFee = !editFee">
                <span class="material-icons">{{
                  editTeams ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="edit-row">
            <span class="edit-label">{{ t.editFormattitle }}</span>
            <div class="value-btn-wrapper">
              <span
                *ngIf="!editFormat && tournament?.format"
                class="edit-value"
                >{{ tournament.format }}</span
              >
              <input
                *ngIf="editFormat"
                [(ngModel)]="tournament.format"
                class="edit-input"
                type="number"
                [placeholder]="tournament?.format"
              />
              <button class="edit-btn" (click)="editFormat = !editFormat">
                <span class="material-icons">{{
                  editFormat ? "check" : "edit"
                }}</span>
              </button>
            </div>
          </div>

          <div class="cancel-container">
            <button
              class="cancel-button"
              (click)="showConfirm = true; cancelTournament(tournament.id)"
            >
              {{ t.cancelButton }}
            </button>
            <div class="confirm-overlay" *ngIf="showConfirm">
              <div class="confirm-box">
                <ng-container *ngIf="!cancelSuccess">
                  <h2>{{ t.title }}</h2>
                  <p>{{ t.description }}</p>
                  <input
                    type="password"
                    [(ngModel)]="confirmPassword"
                    [placeholder]="t.placeholder"
                  />
                  <div class="button-row">
                    <button class="confirm-btn" (click)="confirmCancel()">
                      {{ t.confirmBtn }}
                    </button>
                    <button class="cancel-btn" (click)="closeDialog()">
                      {{ t.cancelBtn }}
                    </button>
                  </div>
                  <div class="error-msg" *ngIf="passwordInvalid">
                    {{ t.error }}
                  </div>
                </ng-container>

                <ng-container *ngIf="cancelSuccess">
                  <h2>{{ t.successTitle }}</h2>
                  <p>{{ t.successText }}</p>
                  <div class="button-row">
                    <button class="confirm-btn" (click)="closeDialog()">
                      {{ t.okBtn }}
                    </button>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="participants-container" *ngIf="participantsSelected">
      <div class="participants-left">
        <h2>{{ t.participantsLabel }}</h2>
        <input
          type="text"
          [(ngModel)]="searchQuery"
          [placeholder]="t.searchPlaceholder"
          class="search-input"
        />

        <div class="players-grid">
          <div
            *ngFor="let player of filteredPlayers(); let i = index"
            class="player-card"
            [ngStyle]="{ 'border-color': getTeamColor(player.team) }"
          >
            <img
              (click)="showPlayerInfo(player)"
              [src]="player.avatar"
              [alt]="t.avatarAlt"
              class="player-avatar"
            />

            <div class="player-info" *ngIf="editIndex !== i">
              <div class="player-name">{{ player.name }}</div>
              <div class="player-team">{{ player.team || t.noTeam }}</div>
            </div>

            <div class="player-info" *ngIf="editIndex === i">
              <input
                [(ngModel)]="player.name"
                class="edit-input"
                [placeholder]="t.namePlaceholder"
              />
              <input
                [(ngModel)]="player.team"
                class="edit-input"
                [placeholder]="t.teamPlaceholder"
              />
            </div>
            <div class="button-group">
              <button class="edit-btn">
                <span class="material-icons">person</span>
              </button>
              <button class="edit-btn" (click)="toggleEdit($event, i)">
                <span class="material-icons">
                  {{ editIndex === i ? "check" : "edit" }}
                </span>
              </button>
              <button class="kick-btn" (click)="kickPlayer($event, player)">
                <span class="material-icons">person_remove</span>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="participants-right">
        <h3>{{ t.invitePlayersLabel }}</h3>
        <input
          type="text"
          [(ngModel)]="inviteQuery"
          [placeholder]="t.invitePlaceholder"
        />
        <button>
          <span class="material-icons">person_add</span> {{ t.inviteButton }}
        </button>

        <h3>{{ t.addGuestLabel }}</h3>
        <input
          type="text"
          [(ngModel)]="guestName"
          [placeholder]="t.guestNamePlaceholder"
        />
        <input
          type="text"
          [(ngModel)]="guestTeam"
          [placeholder]="t.guestTeamPlaceholder"
        />
        <button (click)="addGuest()">
          <span class="material-icons">group_add</span> {{ t.addGuestButton }}
        </button>

        <div class="statistics">
          <div>
            {{ t.participantsCount }}: {{ players.length }} /
            {{ maxParticipants }}
          </div>
          <div>{{ t.withoutTeamCount }}: {{ countPlayersWithoutTeam() }}</div>
        </div>
      </div>
    </div>

    <div class="tournament-bracket-container" *ngIf="bracketSelected">
      <button id="changePhaseBtn" (click)="changePhase()">Change Phase</button>
      <div class="selection-container" *ngIf="phaseNotSelected">
        <h2 class="selection-title">{{ t.choosePhase }}</h2>
        <div class="options">
          <div class="option" tabindex="0" (click)="selectPhase('Group')">
            <div class="icon">
              <svg
                viewBox="0 0 120 120"
                width="320"
                height="320"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  x="15"
                  y="20"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="50"
                  y="20"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="85"
                  y="20"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="15"
                  y="60"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="50"
                  y="60"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="85"
                  y="60"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="27"
                  y1="40"
                  x2="27"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="62"
                  y1="40"
                  x2="62"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="97"
                  y1="40"
                  x2="97"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
              </svg>
            </div>
            <span>{{ t.onlygroup }}</span>
          </div>
          <div class="option" tabindex="0" (click)="selectPhase('Ko')">
            <div class="icon">
              <svg
                viewBox="0 0 120 120"
                width="320"
                height="320"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <circle
                  cx="30"
                  cy="30"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <circle
                  cx="30"
                  cy="90"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <circle
                  cx="90"
                  cy="30"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <circle
                  cx="90"
                  cy="90"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="42"
                  y1="30"
                  x2="78"
                  y2="30"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="42"
                  y1="90"
                  x2="78"
                  y2="90"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="30"
                  y1="42"
                  x2="30"
                  y2="78"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="90"
                  y1="42"
                  x2="90"
                  y2="78"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <circle
                  cx="60"
                  cy="60"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="60"
                  y1="48"
                  x2="60"
                  y2="42"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="60"
                  y1="72"
                  x2="60"
                  y2="78"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="48"
                  y1="60"
                  x2="42"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="72"
                  y1="60"
                  x2="78"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
              </svg>
            </div>
            <span>{{ t.onlykophase }}</span>
          </div>
          <div class="option" tabindex="0" (click)="selectPhase('groupAndKo')">
            <div class="icon">
              <svg
                viewBox="0 0 120 120"
                width="320"
                height="320"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  x="15"
                  y="20"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="50"
                  y="20"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <rect
                  x="85"
                  y="20"
                  width="25"
                  height="20"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="27"
                  y1="40"
                  x2="27"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="62"
                  y1="40"
                  x2="62"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="97"
                  y1="40"
                  x2="97"
                  y2="60"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <circle
                  cx="30"
                  cy="90"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <circle
                  cx="90"
                  cy="90"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="42"
                  y1="90"
                  x2="78"
                  y2="90"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="30"
                  y1="102"
                  x2="30"
                  y2="110"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <line
                  x1="90"
                  y1="102"
                  x2="90"
                  y2="110"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
                <circle
                  cx="60"
                  cy="110"
                  r="12"
                  stroke="var(--accent)"
                  stroke-width="4"
                  fill="none"
                />
                <line
                  x1="60"
                  y1="102"
                  x2="60"
                  y2="90"
                  stroke="var(--accent)"
                  stroke-width="4"
                />
              </svg>
            </div>
            <span>{{ t.groupandko }}</span>
          </div>
        </div>
      </div>
      <div class="group-container">
        <div
          class="onlygroup-container"
          *ngIf="!phaseNotSelected && onlyGroupSelected"
        >
          <h1 id="phaseTitle">{{ t.onlygroup }}</h1>
          <div *ngFor="let group of groups">
            <table class="cornhole-group-table">
              <h2>{{ group.name }}</h2>
              <thead>
                <tr>
                  <th>{{ t.Team }}</th>
                  <th>{{ t.Games }}</th>
                  <th>{{ t.Points }}</th>
                  <th>{{ t.Throws }}</th>
                  <th>{{ t.Hits }}</th>
                  <th>{{ t.Accuracy }}</th>
                  <th>{{ t.Diff }}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let team of group.teams">
                  <td>
                    {{ team.name }}
                    <div class="players-list">
                      <div
                        class="player-entry"
                        *ngFor="let player of getPlayersForTeam(team.name)"
                      >
                        <img
                          [src]="player.avatar"
                          alt="avatar"
                          width="20"
                          height="20"
                        />
                        {{ player.name }}
                      </div>
                    </div>
                  </td>
                  <td>{{ team.games }}</td>
                  <td>{{ team.wins }}</td>
                  <td>{{ team.losses }}</td>
                  <td>{{ team.points }}</td>
                  <td>{{ team.accuracy }}%</td>
                  <td>{{ team.diff }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div
        class="onlykophase-container"
        *ngIf="!phaseNotSelected && onlyKoPhaseSelected"
      >
        <div class="group-container">
          <h1 id="koTitle">{{ t.onlykophase }}</h1>
          <div class="bracket">
            <div
              class="round"
              *ngFor="let round of rounds; let roundIndex = index"
            >
              <div
                class="match-container"
                *ngFor="let match of round; let matchIndex = index"
              >
                <div class="match">
                  <span class="team">{{ match[0]?.team || "TBD" }}</span>
                  <span class="team">{{ match[1]?.team || "TBD" }}</span>
                  <!-- Label f√ºr die erste KO-Runde anzeigen -->
                  <div
                    class="ko-label"
                    *ngIf="roundIndex === 0 && koPairings?.[matchIndex]?.label"
                  >
                    {{ koPairings[matchIndex].label }}
                  </div>
                  <div class="score-input"></div>
                </div>
                <div *ngIf="roundIndex < rounds.length - 1" class="lines">
                  <div class="vert-line top"></div>
                  <div class="horiz-line"></div>
                  <div class="vert-line bottom"></div>
                </div>
              </div>
            </div>
            <div class="champion" *ngIf="rounds.length">
              <h2>Champion üèÜ</h2>
              <span class="team">{{
                rounds[rounds.length - 1][0][0]?.team || "TBD"
              }}</span>
            </div>
          </div>
        </div>
      </div>
      <div class="group-container">
        <div
          class="groupandko-container"
          *ngIf="!phaseNotSelected && groupAndKoSelected"
        >
          <h1 id="phaseTitleboth">{{ t.groupandko }}</h1>
          <div *ngFor="let group of groups">
            <table class="cornhole-group-table">
              <h2>{{ group.name }}</h2>
              <thead>
                <tr>
                  <th>{{ t.Team }}</th>
                  <th>{{ t.Games }}</th>
                  <th>{{ t.Points }}</th>
                  <th>{{ t.Throws }}</th>
                  <th>{{ t.Hits }}</th>
                  <th>{{ t.Accuracy }}</th>
                  <th>{{ t.Diff }}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let team of group.teams">
                  <td>
                    {{ team.name }}
                    <div class="players-list">
                      <div
                        class="player-entry"
                        *ngFor="let player of getPlayersForTeam(team.name)"
                      >
                        <img
                          [src]="player.avatar"
                          alt="avatar"
                          width="20"
                          height="20"
                        />
                        {{ player.name }}
                      </div>
                    </div>
                  </td>
                  <td>{{ team.games }}</td>
                  <td>{{ team.points }}</td>
                  <td>{{ team.wins }}</td>
                  <td>{{ team.losses }}</td>
                  <td>{{ team.accuracy }}%</td>
                  <td>{{ team.diff }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="bracket">
            <div
              class="round"
              *ngFor="let round of rounds; let roundIndex = index"
            >
              <div
                class="match-container"
                *ngFor="let match of round; let matchIndex = index"
              >
                <div class="match">
                  <span class="team">{{ match[0]?.team || "TBD" }}</span>
                  <span class="team">{{ match[1]?.team || "TBD" }}</span>
                  <div class="score-input"></div>
                </div>
                <div *ngIf="roundIndex < rounds.length - 1" class="lines">
                  <div class="vert-line top"></div>
                  <div class="horiz-line"></div>
                  <div class="vert-line bottom"></div>
                </div>
              </div>
            </div>
            <div class="champion" *ngIf="rounds.length">
              <h2>Champion üèÜ</h2>
              <span class="team">{{
                rounds[rounds.length - 1][0][0]?.team || "TBD"
              }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="advanced-settings-wrapper" *ngIf="extendedSelected">
      <div class="advanced-settings-container" *ngIf="extendedSelected">
        <h2>{{ t.advancedSettingsLabel }}</h2>

        <div class="setting-row">
          <div class="setting-item">
            <span class="material-icons">group</span>
            <label>{{ t.ageGroupsLabel }}</label>
            <select id="ageGroup" class="select-input">
              <option value="">{{ t.all }}</option>
              <option value="u18">U18</option>
              <option value="adults">{{ t.adults }}</option>
              <option value="seniors">{{ t.seniors }}</option>
            </select>
          </div>

          <div class="setting-item">
            <span class="material-icons">star</span>
            <label>{{ t.skillLevelLabel }}</label>
            <select id="skillLevel" class="select-input">
              <option value="">{{ t.all }}</option>
              <option value="beginner">{{ t.beginner }}</option>
              <option value="advanced">{{ t.advanced }}</option>
              <option value="pro">{{ t.pro }}</option>
            </select>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-item">
            <span class="material-icons">monetization_on</span>
            <label>{{ t.prizesLabel }}</label>
            <input
              type="text"
              id="prizes"
              class="text-input"
              [placeholder]="t.prizesPlaceholder"
            />
          </div>

          <div class="setting-item">
            <span class="material-icons">emoji_events</span>
            <label>{{ t.leagueLabel }}</label>
            <input
              type="text"
              id="league"
              class="text-input"
              [placeholder]="t.leaguePlaceholder"
            />
          </div>
        </div>

        <div class="sponsor-partner-row">
          <div class="sponsor-partner-item">
            <label>
              <span class="material-icons">business</span> {{ t.sponsorsLabel }}
            </label>

            <button type="button" (click)="addSponsor()">
              {{ t.sponsorsAdd }}
            </button>

            <div
              *ngFor="let sponsor of sponsors; let index = index"
              class="upload-entry"
            >
              <div class="input-wrapper">
                <input
                  type="text"
                  [(ngModel)]="sponsor.name"
                  class="text-input"
                  placeholder="{{ t.sponsorNamePlaceholder }}"
                />
                <button class="delete-button" (click)="deleteSponsor(index)">
                  <span class="material-icons">delete</span>
                </button>
              </div>

              <label class="file-label" [for]="'sponsorLogoInput' + index">
                <span class="material-icons">image</span>
                {{ t.sponsorSelectLogo }}
              </label>
              <input
                type="file"
                [id]="'sponsorLogoInput' + index"
                accept=".jpg,.jpeg,.png,.gif,.webp"
                (change)="onSponsorFileSelected($event, index)"
              />
              <div
                class="logo-preview"
                *ngIf="sponsor.logoUrl"
                (click)="openFullscreen(sponsor.logoUrl)"
              >
                <img [src]="sponsor.logoUrl" alt="{{ t.sponsorLogoAlt }}" />
              </div>
            </div>
          </div>

          <div class="sponsor-partner-item">
            <label>
              <span class="material-icons">link</span> {{ t.partnersLabel }}
            </label>

            <button type="button" (click)="addPartner()">
              {{ t.partnersAdd }}
            </button>

            <div
              *ngFor="let partner of partners; let i = index"
              class="upload-entry"
            >
              <div class="input-wrapper">
                <input
                  type="text"
                  [(ngModel)]="partner.name"
                  class="text-input"
                  placeholder="{{ t.partnerNamePlaceholder }}"
                />
                <button class="delete-button" (click)="deletePartner(i)">
                  <span class="material-icons">delete</span>
                </button>
              </div>

              <label class="file-label" [for]="'partnerLogoInput' + i">
                <span class="material-icons">image</span>
                {{ t.partnerSelectLogo }}
              </label>
              <input
                type="file"
                [id]="'partnerLogoInput' + i"
                accept=".jpg,.jpeg,.png,.gif,.webp"
                (change)="onPartnerFileSelected($event, i)"
              />
              <div
                class="logo-preview"
                *ngIf="partner.logoUrl"
                (click)="openFullscreen(partner.logoUrl)"
              >
                <img [src]="partner.logoUrl" alt="{{ t.partnerLogoAlt }}" />
              </div>
            </div>
          </div>
        </div>

        <div
          class="fullscreen-overlay"
          *ngIf="fullscreenImageUrl"
          (click)="closeFullscreen()"
        >
          <button class="exit-btn" (click)="closeFullscreen($event)">
            {{ t.fullscreenExit }}
          </button>
          <img [src]="fullscreenImageUrl" alt="{{ t.fullscreenAlt }}" />
        </div>
      </div>
    </div>

    <section *ngIf="scheduleSelected" class="match-schedule-container">
      <h2 class="schedule-title">{{ t.scheduleTitle }}</h2>
      <div class="schedule-actions">
        <div class="randomizer-controls">
          <label class="randomizer-label">{{
            t.randomizerTimeRange || "Zeitraum:"
          }}</label>
          <input
            type="time"
            [(ngModel)]="randomizerStartTime"
            class="randomizer-time-input"
            min="06:00"
            max="23:00"
            step="300"
          />
          <span style="color: var(--accent); font-weight: 700">-</span>
          <input
            type="time"
            [(ngModel)]="randomizerEndTime"
            class="randomizer-time-input"
            min="06:00"
            max="23:59"
            step="300"
          />
          <button
            class="randomizer-btn"
            (click)="randomizeMatches()"
            title="{{ t.randomizer }}"
          >
            <span class="material-icons randomizer-dice">casino</span>
            <span class="btn-text">{{ t.randomizer || "Randomizer" }}</span>
          </button>
        </div>
        <button class="add-match-btn" (click)="addMatch()">
          <span class="material-icons">add</span> {{ t.addMatch }}
        </button>
        <button class="edit-hall-btn" (click)="openHallEditor()">
          <span class="material-icons">grid_on</span> {{ t.editHallFields }}
        </button>
      </div>
      <div
        class="hall-modal-backdrop"
        *ngIf="hallEditorOpen"
        (click)="closeHallEditor()"
      ></div>
      <div class="hall-modal" *ngIf="hallEditorOpen">
        <div class="hall-modal-header">
          <h3 id="hall-editor-title">{{ t.hallEditorTitle }}</h3>
          <button class="hall-close-btn" (click)="closeHallEditor()">
            &times;
          </button>
        </div>
        <div class="hall-editor-container">
          <button class="add-field-btn" (click)="addField()">
            <span class="material-icons">add</span> {{ t.addField }}
          </button>
          <div class="hall-visual-container">
            <div
              class="cornhole-hall-bg"
              (mousedown)="$event.stopPropagation()"
              (mousemove)="onHallMouseMove($event)"
              (mouseup)="onHallMouseUp($event)"
              (mouseleave)="onHallMouseUp($event)"
            >
              <div
                *ngFor="let field of hallFields; let idx = index"
                class="cornhole-field-visual"
                [class.selected]="selectedFieldIdx === idx"
                [class.dragging]="isDragging && draggedFieldIdx === idx"
                [ngStyle]="{ left: field.x + '%', top: field.y + '%' }"
                (mousedown)="onHallMouseDown(idx, $event)"
                (touchstart)="onHallMouseDown(idx, $event)"
                (click)="selectField(idx)"
              >
                <div class="field-label">{{ t.field }} {{ idx + 1 }}</div>
                <button
                  class="delete-field-btn"
                  (click)="removeField(idx); $event.stopPropagation()"
                  title="Feld l√∂schen"
                >
                  <span class="material-icons">delete</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="schedule-list">
        <div
          class="match-card"
          *ngFor="let match of matchSchedule; let idx = index"
        >
          <div class="match-header">
            <input
              class="match-time-input"
              [(ngModel)]="match.time"
              [placeholder]="t.time"
            />
            <span class="match-location">
              <span class="material-icons">location_on</span>
              <select
                class="match-location-input styled-select"
                [(ngModel)]="match.fieldIdx"
              >
                <option
                  *ngFor="let field of hallFields; let fIdx = index"
                  [value]="fIdx"
                >
                  {{ t.field }} {{ fIdx + 1 }}
                </option>
              </select>
            </span>
            <button class="delete-match-btn" (click)="removeMatch(idx)">
              <span class="material-icons">delete</span>
            </button>
            <button
              class="move-up-btn"
              (click)="moveMatchUp(idx)"
              [disabled]="idx === 0"
            >
              <span class="material-icons">arrow_upward</span>
            </button>
            <button
              class="move-down-btn"
              (click)="moveMatchDown(idx)"
              [disabled]="idx === matchSchedule.length - 1"
            >
              <span class="material-icons">arrow_downward</span>
            </button>
          </div>
          <div class="match-teams">
            <select class="team-input styled-select" [(ngModel)]="match.teamA">
              <option *ngFor="let team of getTeams()" [value]="team">
                {{ team }}
              </option>
            </select>
            <span style="font-weight: 700; color: var(--accent)">vs</span>
            <select class="team-input styled-select" [(ngModel)]="match.teamB">
              <option *ngFor="let team of getTeams()" [value]="team">
                {{ team }}
              </option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <div *ngIf="resultsSelected" class="tournament-results">
      <h2>{{ t.tournamentResultsTitle }}</h2>
      <div class="results-head">
        <span>{{ t.rank }}</span>
        <span>{{ t.team }}</span>
        <span>{{ t.players }}</span>
        <span>{{ t.matches }}</span>
        <span>{{ t.wins }}</span>
        <span>{{ t.losses }}</span>
      </div>

      <div
        class="results-rows"
        *ngFor="let team of getTeamResults(); let i = index"
        [ngStyle]="{
          '--team-color': getTeamColor(team.teamName)
        }"
      >
        <span>{{ i + 1 }}</span>
        <span>{{ team.teamName }}</span>
        <div class="avatars">
          <img
            *ngFor="let player of team.players"
            [src]="player.avatar"
            [alt]="player.name"
            class="avatar"
            draggable="false"
          />
        </div>
        <span>{{ team.matches }}</span>
        <span>{{ team.wins }}</span>
        <span>{{ team.losses }}</span>
      </div>
    </div>
  </section>

  <section
    *ngIf="presentSelected"
    class="present-section"
    [class.fullscreen]="isPresentFullscreen"
  >
    <div class="present-overlay">
      <div class="mode-switch">
        <button
          [class.active]="presentMode === 'presentation'"
          (click)="setPresentMode('presentation')"
          title="{{ t.presentModePresentation }}"
        >
          <span class="material-icons">slideshow</span>
        </button>
        <button
          [class.active]="presentMode === 'results'"
          (click)="setPresentMode('results')"
          title="{{ t.presentModeResults }}"
        >
          <span class="material-icons">edit</span>
        </button>
        <button
          [class.active]="presentMode === 'resultsView'"
          (click)="setPresentMode('resultsView')"
          title="{{ t.presentModeResultsView || 'Ergebnisse anzeigen' }}"
        >
          <span class="material-icons">visibility</span>
        </button>
        <button
          [class.active]="presentMode === 'playing'"
          (click)="setPresentMode('playing')"
          title="{{ t.presentModePlaying }}"
        >
          <span class="material-icons">play_circle</span>
        </button>
      </div>
      <button
        class="exit-present"
        (click)="exitPresentModus()"
        title="{{ t.exitPresent }}"
      >
        <span class="material-icons">close</span>
      </button>
    </div>
    <div class="present-content">
      <ng-container [ngSwitch]="presentMode">
        <div
          *ngSwitchCase="'presentation'"
          class="slide-container present-slide"
        >
          <div class="slide-content present-slide-content">
            <span class="slide-icon"
              ><span class="material-icons">slideshow</span></span
            >
            <h2>{{ t.presentationSlide + " " + (currentSlide + 1) }}</h2>
            <div class="slide-placeholder">
              {{ t.slideContent }}
            </div>
          </div>
          <div class="slide-controls">
            <button (click)="prevSlide()" [disabled]="currentSlide === 0">
              <span class="material-icons">arrow_back</span>
            </button>
            <span>{{ currentSlide + 1 }} / {{ slides.length }}</span>
            <button
              (click)="nextSlide()"
              [disabled]="currentSlide === slides.length - 1"
            >
              <span class="material-icons">arrow_forward</span>
            </button>
          </div>
        </div>
        <div
          *ngSwitchCase="'results'"
          class="results-entry-container present-results"
        >
          <div class="results-icon">
            <span class="material-icons">edit</span>
          </div>
          <h2>{{ t.enterResults }}</h2>
          <div class="results-entry-list">
            <div *ngIf="matchSchedule && matchSchedule.length">
              <h3>{{ t.matchSchedule }}</h3>
              <div
                class="results-entry-match"
                *ngFor="let match of matchSchedule; let idx = index"
              >
                <span class="results-entry-time">{{ match.time }}</span>
                <span class="results-entry-teams"
                  >{{ match.teamA }} vs {{ match.teamB }}</span
                >
                <input
                  type="number"
                  min="0"
                  [(ngModel)]="match.scoreA"
                  class="results-entry-score styled-score-input"
                  placeholder="A"
                />
                <span class="results-entry-sep">:</span>
                <input
                  type="number"
                  min="0"
                  [(ngModel)]="match.scoreB"
                  class="results-entry-score styled-score-input"
                  placeholder="B"
                />
                <button
                  class="results-entry-save styled-confirm-btn"
                  [ngClass]="{ confirmed: match.confirmed }"
                  (click)="saveMatchResult(idx)"
                  [disabled]="match.confirmed"
                  title="{{
                    match.confirmed ? t.resultConfirmed : t.confirmResult
                  }}"
                >
                  <span class="material-icons">
                    {{
                      match.confirmed ? "check_circle" : "check_circle_outline"
                    }}
                  </span>
                </button>
              </div>
            </div>
            <div *ngIf="groupMatches && groupMatches.length">
              <h3>{{ t.groupPhase }}</h3>
              <div *ngFor="let group of groupMatches">
                <div class="results-entry-group">{{ group.groupName }}</div>
                <div
                  class="results-entry-match"
                  *ngFor="let match of group.matches; let gIdx = index"
                >
                  <span class="results-entry-teams"
                    >{{ match.teamA.name }} vs {{ match.teamB.name }}</span
                  >
                  <input
                    type="number"
                    min="0"
                    [(ngModel)]="match.scoreA"
                    class="results-entry-score styled-score-input"
                    placeholder="A"
                  />
                  <span class="results-entry-sep">:</span>
                  <input
                    type="number"
                    min="0"
                    [(ngModel)]="match.scoreB"
                    class="results-entry-score styled-score-input"
                    placeholder="B"
                  />
                  <button
                    class="results-entry-save styled-confirm-btn"
                    (click)="saveGroupMatchResult(group, gIdx)"
                  >
                    <span class="material-icons">check_circle</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          *ngSwitchCase="'resultsView'"
          class="results-entry-container present-results"
        >
          <div class="results-icon">
            <span class="material-icons">visibility</span>
          </div>
          <h2>{{ t.Results }}</h2>
          <div class="results-entry-list">
            <div *ngIf="matchSchedule && matchSchedule.length">
              <h3>{{ t.matchSchedule }}</h3>
              <div
                class="results-entry-match"
                *ngFor="let match of matchSchedule"
              >
                <span class="results-entry-time">{{ match.time }}</span>
                <span class="results-entry-teams">
                  <ng-container *ngIf="match as m">
                    <span
                      class="results-entry-teams"
                      [ngClass]="{
                        winner:
                          m.scoreA != null &&
                          m.scoreB != null &&
                          m.scoreA > m.scoreB,
                        loser:
                          m.scoreA != null &&
                          m.scoreB != null &&
                          m.scoreA < m.scoreB
                      }"
                    >
                      {{ m.teamA || "-" }}
                    </span>
                    <span class="results-entry-score results-entry-score-view">
                      {{ m.scoreA != null ? m.scoreA : "-" }}
                    </span>
                    <span class="results-entry-score-sep"> - </span>
                    <span class="results-entry-score results-entry-score-view">
                      {{ m.scoreB != null ? m.scoreB : "-" }}
                    </span>
                    <span
                      class="results-entry-teams"
                      [ngClass]="{
                        winner:
                          m.scoreA != null &&
                          m.scoreB != null &&
                          m.scoreB > m.scoreA,
                        loser:
                          m.scoreA != null &&
                          m.scoreB != null &&
                          m.scoreB < m.scoreA
                      }"
                    >
                      {{ m.teamB || "-" }}
                    </span>
                  </ng-container>
                </span>
              </div>
            </div>
            <div *ngIf="groupMatches && groupMatches.length">
              <h3>{{ t.groupPhase }}</h3>
              <div *ngFor="let group of groupMatches">
                <div class="results-entry-group">{{ group.groupName }}</div>
                <div
                  class="results-entry-match"
                  *ngFor="let match of group.matches"
                >
                  <span class="results-entry-teams"
                    >{{ match.teamA.name }} vs {{ match.teamB.name }}</span
                  >
                  <span class="results-entry-score"
                    >{{ match.scoreA != null ? match.scoreA : "-" }} :
                    {{ match.scoreB != null ? match.scoreB : "-" }}</span
                  >
                </div>
              </div>
            </div>
            <div class="results-head">
              <span>{{ t.rank }}</span>
              <span>{{ t.team }}</span>
              <span>{{ t.players }}</span>
              <span>{{ t.matches }}</span>
              <span>{{ t.wins }}</span>
              <span>{{ t.losses }}</span>
            </div>

            <div
              class="results-rows"
              *ngFor="let team of getTeamResults(); let i = index"
              [ngStyle]="{
                '--team-color': getTeamColor(team.teamName)
              }"
            >
              <span>{{ i + 1 }}</span>
              <span>{{ team.teamName }}</span>
              <div class="avatars">
                <img
                  *ngFor="let player of team.players"
                  [src]="player.avatar"
                  [alt]="player.name"
                  class="avatar"
                  draggable="false"
                />
              </div>
              <span>{{ team.matches }}</span>
              <span>{{ team.wins }}</span>
              <span>{{ team.losses }}</span>
            </div>
          </div>
        </div>
        <div
          *ngSwitchCase="'playing'"
          class="playing-mode-container present-playing"
        >
          <div class="playing-message">{{ t.gameOn }}</div>
          <div class="pulse-animation">
            <div class="pulse-circle"></div>
            <div class="pulse-circle"></div>
            <div class="pulse-circle"></div>
          </div>
        </div>
      </ng-container>
    </div>
  </section>
</main>

<footer *ngIf="!presentSelected">
  <p>&copy; 2025 KCA Cornhole Tournaments | All Rights Reserved</p>
  <div class="footer-links">
    <a routerLink="/PrivacyPolicy">{{ t.privacyPolicy }}</a> |
    <a routerLink="/TermsofService">{{ t.termsOfService }}</a> |
    <a routerLink="/contact">{{ t.contact }}</a>
  </div>
</footer>
